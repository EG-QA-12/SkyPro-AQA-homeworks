# Фреймворк автоматизации тестирования

## Обзор

Фреймворк автоматизации тестирования предоставляет набор инструментов и утилит для упрощения написания и выполнения автоматизированных тестов. Он включает в себя API клиенты, фикстуры, утилиты и другие компоненты, которые помогают создавать надежные и поддерживаемые тесты.

## Структура фреймворка

```
framework/
├── api/                    # API клиенты для взаимодействия с различными сервисами
│   ├── base_client.py     # Базовый API клиент с общей функциональностью
│   └── admin_client.py    # Административный API клиент для работы с панелью модерации
├── app/                   # Специфичный код приложения (Page Objects, бизнес-логика)
├── fixtures/              # Фикстуры для pytest
├── new_fixtures/          # Новые централизованные фикстуры
├── test_bases/            # Базовые классы для тестов
├── utils/                 # Вспомогательные утилиты и хелперы
└── README.md             # Этот файл
```

## API клиенты

### BaseAPIClient

Базовый API клиент, который предоставляет общую функциональность для всех API клиентов:

- Автоматическая авторизация и обновление кук
- Обработка CSRF токенов
- Retry логика для 401/419 ошибок
- Централизованная обработка ошибок
- Типизированные ответы

#### Основные методы:
- `get()` - выполнение GET запроса
- `post()` - выполнение POST запроса
- `put()` - выполнение PUT запроса
- `delete()` - выполнение DELETE запроса

### AdminAPIClient

Административный API клиент для работы с панелью модерации:

- Работа с панелью модерации
- Публикация вопросов и ответов
- Взятие записей в работу
- Поиск записей по различным критериям

#### Основные методы:
- `get_moderation_panel_data()` - получение данных из панели модерации
- `find_question()` - поиск вопроса по различным критериям
- `find_answer()` - поиск ответа по различным критериям
- `publish_question()` - публикация вопроса
- `publish_answer()` - публикация ответа
- `assign_entry()` - взятие записи в работу
- `search_questions()` - поиск вопросов в панели модерации

## Утилиты

### AuthCookieProvider
Предоставляет функциональность для работы с авторизационными куками.

### SmartAuthManager
Управляет процессом авторизации и обновления сессий.

### HtmlParser
Парсер HTML страниц для извлечения данных из панели модерации.

## Фикстуры

Фикстуры предоставляют предварительно настроенные компоненты для использования в тестах:

- `admin_client` - административный клиент
- `moder_client` - клиент модератора
- `user_client` - клиент обычного пользователя
- `question_factory` - фабрика для генерации тестовых вопросов

## Базовые классы тестов

### APITestBase
Базовый класс для API тестов, предоставляющий доступ к клиентам и утилитам.

## Примеры использования

```python
# Пример использования API клиентов
from framework.api.admin_client import AdminAPIClient

client = AdminAPIClient(role="admin")
question = client.find_question(mode="latest")
response = client.publish_question(question['id'])
```

```python
# Пример использования фикстур
def test_publish_question(admin_client):
    question = admin_client.find_question(mode="latest")
    response = admin_client.publish_question(question['id'])
    assert response.success
```

## Рекомендации по использованию

1. Используйте API клиенты для взаимодействия с сервисами
2. Используйте фикстуры для получения предварительно настроенных компонентов
3. Используйте утилиты для выполнения специфичных задач
4. Наследуйтесь от базовых классов тестов для упрощения написания тестов
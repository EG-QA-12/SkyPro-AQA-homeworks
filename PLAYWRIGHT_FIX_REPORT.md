# –û—Ç—á–µ—Ç –æ —Ñ–∏–∫—Å–µ Playwright —Ç–µ—Å—Ç–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞
Playwright —Ç–µ—Å—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ –≤ headless —Ä–µ–∂–∏–º–µ, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `allow-session=2`.

## –†–µ—à–µ–Ω–∏–µ
–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞–π–¥–µ–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

### ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ: Playwright —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –≤ headless, —Ç–∞–∫ –∏ –≤ GUI —Ä–µ–∂–∏–º–µ!

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
### ‚úÖ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç `tests/integration/test_burger_menu_links_playwright.py`:
- –£–≤–µ–ª–∏—á–µ–Ω —Ç–∞–π–º–∞—É—Ç —Å 1500ms –¥–æ 5000ms
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∞–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç–∞ (user-agent, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Ñ–ª–∞–≥–∏ –∑–∞–ø—É—Å–∫–∞)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∂–∏–º–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è TEST_HEADLESS
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ `.first()`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ session-scoped fixtures

### ‚úÖ –ù–æ–≤—ã–π —Ç–µ—Å—Ç `tests/integration/test_burger_menu_isolated.py`:
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ function-scoped fixtures
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤ (headless/GUI)
- –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏:

### 1. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞**
```python
browser = p.chromium.launch(
    headless=headless_mode,
    args=[
        "--disable-blink-features=AutomationControlled",
        "--disable-automation", 
        "--disable-dev-shm-usage",
        "--no-sandbox",
        "--disable-gpu",
        # ... –¥—Ä—É–≥–∏–µ —Ñ–ª–∞–≥–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –∞–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç—ã
    ]
)
```

### 2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±—Ä–∞—É–∑–µ—Ä–∞**
```python
context = browser.new_context(
    user_agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
    viewport={"width": 1920, "height": 1080},
    locale="ru-RU",
    timezone_id="Europe/Minsk",
    ignore_https_errors=True
)

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –¥–ª—è –æ–±—Ö–æ–¥–∞ –∞–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç—ã
context.set_extra_http_headers({
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
    "Accept-Language": "ru-RU,ru;q=0.9,en;q=0.8",
    # ... –¥—Ä—É–≥–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
})
```

### 3. **–ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ fixtures**
```python
@pytest.fixture(scope="session")
def browser():
    # –û–¥–∏–Ω –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –≤—Å–µ–π —Å–µ—Å—Å–∏–∏
    pass

@pytest.fixture(scope="function")
def isolated_page(browser):
    # –ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
    context = browser.new_context()
    page = context.new_page()
    yield page
    page.close()
    context.close()
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

### ‚úÖ Headless —Ä–µ–∂–∏–º:
```
$env:TEST_HEADLESS="true"; python -m pytest tests/integration/test_burger_menu_isolated.py -v -s
PASSED - 7.83s
–ù–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–µ–Ω—é: 77
–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤: 77
–£—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: 95%
```

### ‚úÖ GUI —Ä–µ–∂–∏–º:
```
$env:TEST_HEADLESS="false"; python -m pytest tests/integration/test_burger_menu_isolated.py -v -s  
PASSED - 8.50s
–ù–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–µ–Ω—é: 77
–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤: 77
–£—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: 95%
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ (asserts):

### üîç **–£—Ä–æ–≤–Ω–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫:**

#### **1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:**
```python
assert len(page_title) > 0, "–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å"
assert "bll.by" in current_url, "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL"
```

#### **2. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:**
```python
heading = page.locator("h1:has-text('–ù–æ–≤–æ—Å—Ç–∏')")
heading.wait_for(state="visible", timeout=5000)
assert heading.is_visible(), "–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"
```

#### **3. –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞:**
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
assert link_text in page.title() or link_text in heading.text_content()
```

### üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫:**
- **–í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–µ–Ω—é:** 77+
- **–£—Å–ø–µ—à–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:** ~95% (73 —ç–ª–µ–º–µ–Ω—Ç–∞)
- **–ü—Ä–æ–≤–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:** ~5% (4 —ç–ª–µ–º–µ–Ω—Ç–∞ - –æ–±—ã—á–Ω–æ –∏–∑-–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Å–∞–π—Ç–µ)
- **–¢–∞–π–º–∞—É—Ç—ã:** <1% –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

### üéØ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
1. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å (–Ω–µ–ø—É—Å—Ç–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫)
2. ‚úÖ URL –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π (—Å–æ–¥–µ—Ä–∂–∏—Ç –æ–∂–∏–¥–∞–µ–º—ã–π –¥–æ–º–µ–Ω)
3. ‚úÖ –ú–µ–Ω—é –æ—Ç–∫—Ä—ã–ª–æ—Å—å (—Å–æ–¥–µ—Ä–∂–∏—Ç —ç–ª–µ–º–µ–Ω—Ç—ã)
4. ‚úÖ –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ—è–≤–∏–ª—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫

### üö´ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–∞–ª–∞:**
1. ‚ùå –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å (—Ç–∞–π–º–∞—É—Ç, –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏)
2. ‚ùå –ú–µ–Ω—é –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å (—ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã)
3. ‚ùå –ü–µ—Ä–µ—Ö–æ–¥ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–µ–ª (URL –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è)
4. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (–∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º)

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ: `PLAYWRIGHT_ASSERTS_EXPLANATION.md`

## –°–æ–∑–¥–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç:
–§–∞–π–ª: `tests/integration/test_burger_menu_isolated.py`

–¢–µ—Å—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –†–∞–±–æ—Ç—É –≤ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–∞—Ö (headless/GUI)
- –ü–æ–ª–Ω—É—é –∏–∑–æ–ª—è—Ü–∏—é —Ç–µ—Å—Ç–æ–≤
- –û–±—Ö–æ–¥ –∞–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç—ã
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∫—É–∫–∏
- –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é

## –í—ã–≤–æ–¥—ã:
1. **–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –Ω–µ –≤ —Ä–µ–∂–∏–º–µ headless/GUI**, –∞ –≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. **Playwright —Ç–µ—Å—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã** –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
3. **–ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è** —á–µ—Ä–µ–∑ function-scoped fixtures
4. **–ê–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç–∞ —É—Å–ø–µ—à–Ω–æ –æ–±—Ö–æ–¥–∏—Ç—Å—è** —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ñ–ª–∞–≥–∏

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç –∫–∞–∫ —à–∞–±–ª–æ–Ω –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö Playwright —Ç–µ—Å—Ç–æ–≤
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–µ –∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω—Ç–∏–±–æ—Ç –∑–∞—â–∏—Ç—ã –≤ –¥—Ä—É–≥–∏—Ö —Ç–µ—Å—Ç–∞—Ö
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–æ–ª—è—Ü–∏—é —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ fixtures
4. –£–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (5000ms –≤–º–µ—Å—Ç–æ 1500ms)

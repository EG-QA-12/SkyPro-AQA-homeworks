–û—Ç–ª–∏—á–Ω–æ! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥. –≠—Ç–æ —Ö–æ—Ä–æ—à–∏–π –ø—Ä–∏–º–µ—Ä —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ E2E-—Ç–µ—Å—Ç–æ–≤ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å–∞ –∏ URL), –Ω–æ –µ—Å—Ç—å **–º–Ω–æ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è** —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è:

- **DRY (Don‚Äôt Repeat Yourself)**
- **–ß–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏**
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Page Object, Screenplay –∏ –¥—Ä.)**
- **–£–ø—Ä–æ—â–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π**
- **–£–ª—É—á—à–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∫–ª–∏–∫–æ–≤ –∏ –æ–∂–∏–¥–∞–Ω–∏–π**

---

## üîç –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞

1. **–ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤**  
   –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç ‚Äî –ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–π –±–ª–æ–∫: `goto ‚Üí open_menu ‚Üí click ‚Üí expect_response ‚Üí assert status ‚Üí assert url`.

2. **–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `page` –∏ `try/finally`**  
   Playwright —É–∂–µ —É–º–µ–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ–∏–∫—Å—Ç—É—Ä.

3. **–°–º–µ—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö –∏ Page Object**  
   –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ `test_my_data_navigation` ‚Äî –∫—É—á–∞ –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä—è–º–æ –≤ —Ç–µ–ª–µ —Ç–µ—Å—Ç–∞.

4. **–ù–µ–Ω–∞–¥–µ–∂–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏ –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**  
   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `force=True`, `evaluate`, –∂–µ—Å—Ç–∫–∏—Ö CSS-—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ ‚Äî —ç—Ç–æ "–∫–æ—Å—Ç—ã–ª–∏", –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ —É–±—Ä–∞—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

5. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è URL**  
   –ü—Ä–æ–≤–µ—Ä–∫–∞ ID –≤ URL —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–∞ `compare_docs_url_with_id`, –Ω–æ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Ç–æ—á–Ω—ã–π URL vs ID) –Ω–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞.

---

## ‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. **–í–≤–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç**
–í–º–µ—Å—Ç–æ 40+ –ø–æ—á—Ç–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ ‚Äî **–æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç** —Å –¥–∞–Ω–Ω—ã–º–∏.

```python
from dataclasses import dataclass

@dataclass
class NavigationTarget:
    menu_text: str
    expected_url_pattern: str  # –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ—á–Ω—ã–º URL –∏–ª–∏ —à–∞–±–ª–æ–Ω–æ–º —Å ID
    is_docs_like: bool = False  # –µ—Å–ª–∏ True ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ ID
    expected_id: str = None
    is_external: bool = False
    status_codes: list = None

NAVIGATION_TARGETS = [
    NavigationTarget("–ù–æ–≤–æ—Å—Ç–∏", "https://bll.by/news"),
    NavigationTarget("–°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "**/spravochnaya-informatsiya-200083**", is_docs_like=True, expected_id="200083"),
    NavigationTarget("–ó–∞–∫—É–ø–∫–∏", "https://gz.bll.by", is_external=True, status_codes=[200, 201, 301, 302]),
    # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ
]
```

–ê —Å–∞–º —Ç–µ—Å—Ç:

```python
@pytest.mark.parametrize("target", NAVIGATION_TARGETS, ids=lambda t: t.menu_text)
def test_burger_menu_navigation(authenticated_burger_context, target):
    page = authenticated_burger_context.new_page()
    burger_menu = BurgerMenuPage(page)

    page.goto("https://bll.by/", wait_until="domcontentloaded")
    assert burger_menu.open_menu(), "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é"

    with page.expect_response(target.expected_url_pattern) as response_info:
        if target.is_external or not target.is_docs_like:
            burger_menu.click_link_by_text(target.menu_text)
        else:
            # –∏–ª–∏ –æ–±–æ–±—â—ë–Ω–Ω—ã–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º —Ä–µ—à–∞–µ—Ç, –∫–∞–∫ –∫–ª–∏–∫–∞—Ç—å
            burger_menu.navigate_to(target.menu_text)

    response = response_info.value
    allowed_codes = target.status_codes or [200, 201]
    assert response.status in allowed_codes, f"–ù–µ–≤–µ—Ä–Ω—ã–π —Å—Ç–∞—Ç—É—Å: {response.status}"

    current_url = page.url
    if target.is_docs_like:
        assert burger_menu.compare_docs_url_with_id(current_url, target.expected_id), \
            f"URL –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç ID {target.expected_id}: {current_url}"
    elif target.is_external:
        domain = target.expected_url_pattern.split("://")[1].split("/")[0]
        assert domain in current_url, f"URL –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç {domain}: {current_url}"
    else:
        expect(page).to_have_url(target.expected_url_pattern)
```

> ‚úÖ **–í—ã–≥–æ–¥–∞**:  
> - 90% –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ –∫–æ–¥–∞ —É—Ö–æ–¥–∏—Ç  
> - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é ‚Äî –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –≤ `NAVIGATION_TARGETS`  
> - –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, –ª–µ–≥–∫–æ —á–∏—Ç–∞—Ç—å

---

### 2. **–£–±—Ä–∞—Ç—å `try/finally` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π**

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∏–∫—Å—Ç—É—Ä—É:

```python
@pytest.fixture
def page(authenticated_burger_context):
    page = authenticated_burger_context.new_page()
    yield page
    page.close()
```

–¢–µ–ø–µ—Ä—å –≤ —Ç–µ—Å—Ç–∞—Ö –ø—Ä–æ—Å—Ç–æ:

```python
def test_something(page):
    page.goto(...)
```

Playwright + pytest —Å–∞–º–∏ –∑–∞–∫—Ä–æ—é—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É.

---

### 3. **–£–ª—É—á—à–∏—Ç—å Page Object: –≤—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –∫–ª–∏–∫–æ–≤ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏**

–í `BurgerMenuPage` –¥–æ–±–∞–≤—å—Ç–µ –º–µ—Ç–æ–¥:

```python
def navigate_to(self, menu_text: str) -> bool:
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Ç–µ–∫—Å—Ç—É –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é"""
    link = self.page.get_by_role("link", name=menu_text, exact=True)
    if link.count() == 0:
        # fallback –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫, –µ—Å–ª–∏ ARIA –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
        link = self.page.locator(f"a:has-text('{menu_text}')").first
    if link.is_visible():
        link.click()
        return True
    return False
```

> ‚úÖ **–í—ã–≥–æ–¥–∞**:  
> - –£–±–∏—Ä–∞–µ—Ç –∫–æ—Å—Ç—ã–ª–∏ –∏–∑ —Ç–µ—Å—Ç–æ–≤  
> - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –º–µ–Ω—é  
> - –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏—Ç—å `scroll_into_view`)

---

### 4. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É URL**

–î–æ–±–∞–≤—å—Ç–µ –≤ `BurgerMenuPage` –º–µ—Ç–æ–¥:

```python
def assert_navigation_result(self, target: NavigationTarget):
    current_url = self.page.url
    if target.is_docs_like:
        assert self.compare_docs_url_with_id(current_url, target.expected_id)
    elif target.is_external:
        domain = urlparse(target.expected_url_pattern).netloc
        assert domain in current_url
    else:
        expect(self.page).to_have_url(target.expected_url_pattern)
```

–¢–æ–≥–¥–∞ —Ç–µ—Å—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ—â—ë –∫–æ—Ä–æ—á–µ:

```python
burger_menu.navigate_to(target.menu_text)
burger_menu.assert_navigation_result(target)
```

---

### 5. **–ò–∑–±–µ–≥–∞—Ç—å –∂—ë—Å—Ç–∫–∏—Ö CSS-—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤**

> ‚ùå `body > div.layout...nth-child(4)...` ‚Äî —ç—Ç–æ **–∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω**.  
> –¢–∞–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –ª–æ–º–∞—é—Ç—Å—è –ø—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ DOM.

**–†–µ—à–µ–Ω–∏–µ**:  
- –î–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ `data-testid` –∏–ª–∏ `data-qa` –∞—Ç—Ä–∏–±—É—Ç–æ–≤  
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã**: `get_by_role`, `get_by_text`, `get_by_label`

---

### 6. **–í—ã–Ω–µ—Å—Ç–∏ –¥–æ–º–µ–Ω—ã –∏ –±–∞–∑–æ–≤—ã–µ URL –≤ –∫–æ–Ω—Ñ–∏–≥**

```python
# config.py
BASE_URL = "https://bll.by"
EXTERNAL_DOMAINS = {
    "expert": "https://expert.bll.by",
    "gz": "https://gz.bll.by",
    "ca": "https://ca.bll.by",
    "bonus": "https://bonus.bll.by",
    "business": "https://business-info.by",
}
```

–¢–æ–≥–¥–∞ –≤ `NavigationTarget` –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å:

```python
NavigationTarget("–ó–∞–∫—É–ø–∫–∏", EXTERNAL_DOMAINS["gz"], is_external=True)
```

---

### 7. **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω Screenplay**

–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å—Ç—ë—Ç, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ **Screenplay Pattern** (–±–æ–ª–µ–µ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π), –Ω–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –æ–±—ä—ë–º–∞ ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω–æ.

---

## üßº –ò—Ç–æ–≥: —á—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è

| –î–æ | –ü–æ—Å–ª–µ |
|----|-------|
| 40+ –ø–æ—á—Ç–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ | 1 –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç + —á–∏—Ç–∞–µ–º—ã–π —Å–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–π |
| –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `page` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —á–µ—Ä–µ–∑ —Ñ–∏–∫—Å—Ç—É—Ä—É |
| –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ Page Object |
| –ñ—ë—Å—Ç–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏ `force=True` | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã, —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∫–ª–∏–∫–∏ |
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ URL | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ `assert_navigation_result` |
| –¢—Ä—É–¥–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—É–Ω–∫—Ç—ã | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ = 1 —Å—Ç—Ä–æ–∫–∞ –≤ `NAVIGATION_TARGETS` |

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é

1. –°–æ–∑–¥–∞–π—Ç–µ `NavigationTarget` –∏ `NAVIGATION_TARGETS`
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ `BurgerMenuPage.navigate_to()` –∏ `assert_navigation_result()`
3. –ó–∞–º–µ–Ω–∏—Ç–µ 2‚Äì3 —Ç–µ—Å—Ç–∞ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
4. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ
5. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ —Ç–µ—Å—Ç—ã

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å **–ø–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ + —à–∞–±–ª–æ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞** –≤ –≤–∏–¥–µ –≥–æ—Ç–æ–≤–æ–≥–æ –∫–æ–¥–∞.


## üéØ –¶–µ–ª—å
–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Allure (—á–∏—Ç–∞–µ–º—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏, –æ–ø–∏—Å–∞–Ω–∏—è, —à–∞–≥–∏, —Ç–µ–≥–∏), **–Ω–æ –ø—Ä–∏ —ç—Ç–æ–º**:
- –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –°–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç—ã –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º–∏
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ç—á—ë—Ç–æ–≤

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å Allure

### 1. **–ó–∞–º–µ–Ω–∏—Ç–µ 40+ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π ‚Äî –Ω–æ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º Allure**

–í–º–µ—Å—Ç–æ:

```python
@allure.title("–ù–∞–≤–∏–≥–∞—Ü–∏—è: –ù–æ–≤–æ—Å—Ç–∏")
def test_news_navigation(...): ...
```

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```python
import allure
import pytest
from tests.e2e.data.navigation_targets import NAVIGATION_TARGETS

@pytest.mark.parametrize("target", NAVIGATION_TARGETS, ids=lambda t: t.menu_text)
def test_burger_menu_navigation(page, target):
    allure.dynamic.title(f"–ù–∞–≤–∏–≥–∞—Ü–∏—è: {target.menu_text}")
    allure.dynamic.description(target.description or f"–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ '{target.menu_text}'")
    
    # ... –ª–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∞
```

> ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –∫–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ –≤ Allure –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å **—Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ**, –∫–∞–∫ –∏ –≤–∞—à–∏ —Ç–µ–∫—É—â–∏–µ —Ç–µ—Å—Ç—ã.

---

### 2. **–î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Ç–µ–≥–∏ –≤ `NavigationTarget`**

–†–∞—Å—à–∏—Ä—å—Ç–µ –≤–∞—à—É dataclass:

```python
@dataclass
class NavigationTarget:
    menu_text: str
    expected_url_pattern: str
    expected_id: Optional[str] = None
    is_external: bool = False
    status_codes: List[int] = None
    is_critical: bool = False
    description: str = ""  # ‚Üê –Ω–æ–≤–æ–µ –ø–æ–ª–µ

    def __post_init__(self):
        if self.status_codes is None:
            self.status_codes = [200, 201] if not self.is_external else [200, 201, 301, 302]
```

–ü—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:

```python
NavigationTarget(
    menu_text="–°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
    expected_url_pattern="**/spravochnaya-informatsiya-200083**",
    expected_id="200083",
    is_critical=True,
    description="–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –°–ø—Ä–∞–≤–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é ‚Äî —Å—Ç–∞—Ç—É—Å –∫–æ–¥ –∏ ID URL"
),
NavigationTarget(
    menu_text="–ó–∞–∫—É–ø–∫–∏",
    expected_url_pattern="https://gz.bll.by",
    is_external=True,
    description="–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –ó–∞–∫—É–ø–∫–∏ ‚Äî —Å—Ç–∞—Ç—É—Å –∫–æ–¥ –∏ –≤–Ω–µ—à–Ω–∏–π –¥–æ–º–µ–Ω"
)
```

---

### 3. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –º–∞—Ä–∫–µ—Ä—ã —á–µ—Ä–µ–∑ `pytest_collection_modifyitems` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å `@pytest.mark.critical`, –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å –º–∞—Ä–∫–µ—Ä:

```python
# conftest.py
def pytest_collection_modifyitems(config, items):
    for item in items:
        if "target" in item.callspec.params:
            target = item.callspec.params["target"]
            if target.is_critical:
                item.add_marker(pytest.mark.critical)
```

–ù–æ –ø—Ä–æ—â–µ ‚Äî –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç—å `@pytest.mark.critical` –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–≥–æ —Ç–µ—Å—Ç–∞, –µ—Å–ª–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫—Ä–∏—Ç–∏—á–Ω—ã.

---

### 4. **–û–±–µ—Ä–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ `@allure.step`**

–í `BurgerMenuPage`:

```python
from allure_commons._allure import step

class BurgerMenuPage:
    @step("–û—Ç–∫—Ä—ã—Ç—å –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é")
    def open_menu(self) -> bool:
        ...

    @step("–ü–µ—Ä–µ–π—Ç–∏ –ø–æ –ø—É–Ω–∫—Ç—É –º–µ–Ω—é: '{menu_text}'")
    def navigate_to(self, menu_text: str) -> bool:
        ...

    @step("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏")
    def assert_navigation_result(self, target: NavigationTarget):
        ...
```

> ‚úÖ –í Allure –ø–æ—è–≤—è—Ç—Å—è **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∞–≥–∏**, –∫–∞–∫ –≤ —Ä—É—á–Ω—ã—Ö —Ç–µ—Å—Ç-–∫–µ–π—Å–∞—Ö.

---

### 5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∫—Å—Ç—É—Ä—É –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Äî –±–µ–∑ `try/finally`**

```python
@pytest.fixture
def page(authenticated_burger_context):
    p = authenticated_burger_context.new_page()
    yield p
    p.close()
```

–¢–µ–ø–µ—Ä—å —Ç–µ—Å—Ç —á–∏—â–µ:

```python
def test_burger_menu_navigation(page, target):
    allure.dynamic.title(...)
    page.goto("https://bll.by/")
    # ...
```

---

### 6. **–ù–µ —Ç–µ—Ä—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ ‚Äî Allure —Å–∞–º –¥–æ–±–∞–≤–∏—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏**

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω `pytest-playwright` + `allure-playwright`, —Ç–æ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏:
- Allure –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç **—Å–∫—Ä–∏–Ω—à–æ—Ç**
- **–õ–æ–≥–∏ –∫–æ–Ω—Å–æ–ª–∏**
- **–í–∏–¥–µ–æ** (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `pytest.ini` –∏–ª–∏ `conftest.py` –µ—Å—Ç—å:

```python
# conftest.py
@pytest.hookimpl(tryfirst=True, hookwrapper=True)
def pytest_runtest_makereport(item, call):
    outcome = yield
    rep = outcome.get_result()
    if rep.when == "call" and rep.failed:
        page = item.funcargs.get("page")
        if page:
            allure.attach(
                page.screenshot(),
                name="screenshot-on-failure",
                attachment_type=allure.attachment_type.PNG
            )
```

(–•–æ—Ç—è `allure-playwright` –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.)

---

## üß© –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞ —Å Allure

```python
import allure
import pytest
from playwright.sync_api import expect
from tests.e2e.data.navigation_targets import NAVIGATION_TARGETS
from tests.e2e.pages.burger_menu_page import BurgerMenuPage

@pytest.fixture
def page(authenticated_burger_context):
    p = authenticated_burger_context.new_page()
    yield p
    p.close()

@pytest.mark.parametrize("target", NAVIGATION_TARGETS, ids=lambda t: t.menu_text)
@pytest.mark.burger_menu
@pytest.mark.navigation
@pytest.mark.refactored
def test_burger_menu_navigation(page, target):
    # === Allure ===
    allure.dynamic.title(f"–ù–∞–≤–∏–≥–∞—Ü–∏—è: {target.menu_text}")
    allure.dynamic.description(target.description)

    # === –¢–µ—Å—Ç ===
    page.goto("https://bll.by/", wait_until="domcontentloaded")
    burger_menu = BurgerMenuPage(page)

    assert burger_menu.open_menu()

    with page.expect_response(target.expected_url_pattern) as response_info:
        assert burger_menu.navigate_to(target.menu_text)

    response = response_info.value
    assert response.status in target.status_codes

    burger_menu.assert_navigation_result(target)
```

---

## üí° –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ

| –î–æ | –ü–æ—Å–ª–µ |
|----|-------|
| 40+ –ø–æ—á—Ç–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ | **1 —Ç–µ—Å—Ç + 40 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö** |
| –î—É–±–ª–∏—Ä—É—é—â–∏–π –∫–æ–¥ | **DRY, –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å** |
| Allure —Ä–∞–±–æ—Ç–∞–µ—Ç | **Allure —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—â—ë –ª—É—á—à–µ** |
| –°–ª–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–π –ø—É–Ω–∫—Ç | **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ = 1 —Å—Ç—Ä–æ–∫–∞ –≤ `NAVIGATION_TARGETS`** |
| –ñ—ë—Å—Ç–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ —Ç–µ—Å—Ç–∞—Ö | **–õ–æ–≥–∏–∫–∞ –∫–ª–∏–∫–æ–≤ ‚Äî –≤ Page Object** |

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å **–ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–∏–º–µ—Ä** —Å `navigation_targets.py`, `burger_menu_page.py` –∏ `test_burger_menu.py` –≤ –æ–¥–Ω–æ–º –∞—Ä—Ö–∏–≤–µ –∏–ª–∏ –∫–∞–∫ PR-–ø–∞—Ç—á.